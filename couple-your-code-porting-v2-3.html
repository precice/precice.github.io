<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="description" content="This guide helps you to upgrade from preCICE 2.x to preCICE 3.x.">

<meta name="keywords" content=" api, adapter, version, time step, action">
<meta name="theme-color" content="#0A76BB">
<meta name="msapplication-square310x310logo" content="images/icon-310x310.png">

<title>Porting from 2.x to 3.x | preCICE - The Coupling Library</title>
<link rel="alternate" type="application/rss+xml" title="" href="https://precice.org/feed.xml">

<!-- OpenGraph metadata -->
<meta property="og:title" content="Porting from 2.x to 3.x" />
<meta property="og:site_name" content="preCICE.org" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://precice.org/page.url" />
<meta property="og:image" content="https://precice.org/images/icon.svg" />
<meta property="og:description" content="This guide helps you to upgrade from preCICE 2.x to preCICE 3.x.">

<!-- Cannonical link -->
<link rel="canonical" href="https://precice.org/couple-your-code-porting-v2-3" >

<link rel="shortcut icon" href="images/favicon.ico">
<link rel="stylesheet" href="css/syntax.css">
<link rel="icon" sizes="192x192" href="images/icon.png">
<link rel="apple-touch-icon" sizes="310x310" href="images/icon-310x310.png">

<!-- Font Awesome -->
<link rel="stylesheet" 
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">

<!-- Bootstrap -->
<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Local CSS -->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/customstyles-precice.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<link rel="stylesheet" href="css/bookcover.css">
<!-- Color styles -->
<link rel="stylesheet" href="css/theme-precice.css">
<!-- Styling for landing page -->


<!-- Jquery, Ajax -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js"></script>

<!-- Anchor.js -->
<script src="https://cdn.jsdelivr.net/npm/anchor-js@4.2.0/anchor.min.js" integrity="sha256-m1eTvwEHwmsw4+XKF7BshClVJEPwTVycveNl0CS0Mkk=" crossorigin="anonymous"></script>

<!-- Bootstrap JavaScript (requires jquery) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Local JS -->
<script src="js/jquery.navgoco.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- KaTeX -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<!-- The loading of KaTeX is deferred to speed up page rendering -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<!-- To automatically render math in text elements, include the auto-render extension: -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

<!-- Algolia search -->
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.20.1/moment.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

<!-- QR code to retrieve printed page -->
<style>
@media print {
    div.post-header:before {
    	content: url('https://chart.googleapis.com/chart?cht=qr&chs=100x100&chl=https://precice.org/couple-your-code-porting-v2-3.html&choe=UTF-8');
        margin-top: -25px;
        float: right;
    }
}
</style>

<!-- Plausible Analytics -->
<script async defer data-domain="precice.org" src="https://plausible.io/js/plausible.js"></script>

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    <script>
        // wrap tables into a div to make them scrollable on small viewports
        // https://getbootstrap.com/docs/3.4/css/#tables-responsive
        $(document).ready(function() {
            $('table').addClass('table');
            $('table').wrap('<div class="table-responsive"></div>');
        });
    </script>
    
</head>
<body>
    <header>
        <a!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top" aria-label="Main">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://precice.org">
            <span class="navbar-brand-icon">
            <img class="navbar-brand-text" src="images/preCICE_text_28px.svg" alt="preCICE"></span>
            </a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                
                <!-- entries without drop-downs appear here -->

                
                

                
                
                
                
                
                <li><a href="quickstart.html">Quickstart</a></li>
                
                
                
                
                
                <li class="active"><a href="docs.html">Docs</a></li>
                
                
                
                
                
                <li><a href="tutorials.html">Tutorials</a></li>
                
                
                
                
                
                <li><a href="community.html">Community</a></li>
                
                
                
                
                
                <li><a href="https://precice.discourse.group/c/news" target="_blank" rel="noopener">Blog</a></li>
                
                
                
                
                
                <li><a href="about.html">About</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                

                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <div id="search-input"></div>
                        <div id="search-results"></div>
                        <script>
const algoliaSearch = instantsearch({
  appId: 'LIT6P0EW26',
  apiKey: '760ed6be3e165d08b4a798ac4aa82fe4',
  indexName: 'jekyll',
  searchFunction: function(helper) {          // hide search result in init query
    var searchResults = $('#search-results');
    if (helper.state.query === '') {
      searchResults.hide();
      return;
    }
    helper.search();
    searchResults.show();
  }
});

const hitTemplate = function(hit) {
  let date = '';
  if (hit.date) {
    date = moment.unix(hit.date).format('MMM D, YYYY');
  }

  let url = `${hit.url}#${hit.anchor}`;

  const title = hit._highlightResult.title.value;

  let breadcrumbs = '';
  if (hit._highlightResult.headings) {
    breadcrumbs = hit._highlightResult.headings.map(match => {
      return `<span class="result-breadcrumb">${match.value}</span>`
    }).join(' > ')
  }

  const content = hit._highlightResult.html.value;

  return `
    <div class="result-item">
    <h2><a class="result-link" href="${url}">${title}</a></h2>
    <a href="${url}" class="result-breadcrumbs">${breadcrumbs}</a>
    <div class="result-snippet">${content}</div>
    </div>
  `;
}

algoliaSearch.addWidget(
  instantsearch.widgets.searchBox({
    container: '#search-input',
    placeholder: 'Search ...',
    poweredBy: true, // This is required if you're on the free Community plan
    magnifier: false,
    autofocus: false,
    searchOnEnterKeyPressOnly: false,
    reset: true
  })
);

algoliaSearch.addWidget(
  instantsearch.widgets.hits({
    container: '#search-results',
    templates: {
      item: hitTemplate
    }
  })
);

algoliaSearch.start();

// Patch the style of the search input bar generated by the above script
// The equivalent CSS is below, however, including <style> in <body> is against the W3C commandments
// Chrome and Firefox had baby called scope, but it didn't make it
// https://stackoverflow.com/questions/2830296/using-style-tags-in-the-body-with-other-html
var elem = document.querySelector('.ais-search-box--powered-by');
elem.style.marginTop = '-15px';
elem.style.paddingRight = '5px';

var elem = document.querySelector('.nav li a.ais-search-box--powered-by-link');
elem.style.padding = '0';
elem.style.backgroundColor = 'transparent';
elem.style.display = "inline-block";

var elem = document.querySelector('.ais-search-box--input');
elem.style.paddingLeft = '10px';
elem.style.borderColor = '#0A76BB';

var elem = document.querySelector('.ais-search-box');
elem.style.padding = '.5em';
elem.style.marginBottom = '0px';
elem.style.marginLeft = '10px';
elem.style.marginTop = '0px';
elem.style.width = '20em';
elem.style.fontSize = '0.8em';
elem.style.height = '50px';
elem.style.boxSizing = 'border-box';

/*<style type="text/css">
.ais-search-box--powered-by {
  margin-top: -15px;
  padding-right: 5px;
}
.nav li a.ais-search-box--powered-by-link {
  padding: 0;
  background-color: transparent;
  display: inline-block;
}
.ais-search-box--input {
  padding-left: 10px;
  border-color: #0A76BB;
}
.ais-search-box {
  padding: .5em;
  margin-bottom: 0px;
  margin-left: 10px;
  margin-top: 0px;
  width: 20em;
  font-size: 0.8em;
  box-sizing: border-box;
  height: 50px;
}
</style>*/

// some hacky JS to hide the search results until we move to docsearch (which is a true autocomplete-type search)
document.addEventListener('mouseup', function(e) {
  var results = document.getElementById('search-results');
  if (!results.contains(e.target)) {
    results.style.display = 'none';
  }
});
document.addEventListener('mouseup', function(e) {
  var input = document.getElementById('search-input');
  var results = document.getElementById('search-results');
  if (input.contains(e.target)) {
    results.style.display = 'block';
  }
});

</script>
                    </div>
                    <!--end search-->
                </li>
                <li>
                    <a class="no-icon nav-external" href="https://precice.discourse.group" target="_blank" data-show-count="false" aria-label="Join the discourse community"><i class="fab fa-discourse"></i></a>
                </li>
                <li>
                    <a class="no-icon nav-external" href="https://github.com/precice" target="_blank" data-show-count="false" aria-label="Star precice/precice on GitHub"><i class="fab fa-github"></i></a>
                </li>
                <li>
                    <!-- rel="me" required by Mastodon for verification -->
                    <a rel="me" class="no-icon nav-external" href="https://fosstodon.org/@precice" target="_blank" data-show-count="false" aria-label="Follow us on Mastodon"><i class="fab fa-mastodon"></i></a>
                </li>
                <li>
                    <a class="no-icon nav-external" href="https://bsky.app/profile/precice.org" target="_blank" data-show-count="false" aria-label="Follow us on Bluesky"><i class="fab fa-bluesky"></i></a>
                </li>
                <li>
                    <a class="no-icon nav-external" href="https://www.youtube.com/c/preCICECoupling/" target="_blank" data-show-count="false" aria-label="Subscribe on Youtube"><i class="fab fa-youtube"></i></a>
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

          <!-- News banner -->
          



<aside role="banner" class="background-light banner-container">
  <div class="container">
    <div class="row no-margin">
      <div class="col-lg-12 banner">
        <p class="no-margin">
          Call for contributions and registration open: <a href="precice-workshop-2025.html">preCICE Workshop 2025, Hamburg, Sep 8-12 </a>
        </p>
      </div>
    </div>
  </div>
</aside>



    </header>
    <div class="container" style="margin-bottom:50px">
        
        <div class="row">
          <div class="col-md-3" id="tg-sb-sidebar">
            

<nav aria-label="Documentation">
<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">Documentation </li>
  
  
  
  
  
  
  <!-- Parent menu item has folderitems -->
  <li>
    <a title="Fundamentals" href="#">Fundamentals</a>
    <ul>
      
      
      
      <li><a title="Overview" href="docs.html">Overview</a></li>
      
      
      
      
      
      
      <li><a title="Terminology" href="fundamentals-terminology.html">Terminology</a></li>
      
      
      
      
      
      
      <li><a title="License information" href="fundamentals-license.html">License information</a></li>
      
      
      
      
      
      
      <li><a title="Literature guide" href="fundamentals-literature-guide.html">Literature guide</a></li>
      
      
      
      
      
      
      <li><a title="Roadmap" href="fundamentals-roadmap.html">Roadmap</a></li>
      
      
      
      
      
      
      <li><a title="Previous versions" href="fundamentals-previous-versions.html">Previous versions</a></li>
      
      
      
      
    </ul>
  </li>
  
  
  
  
  
  <!-- Parent menu item has folderitems -->
  <li>
    <a title="Installation" href="#">Installation</a>
    <ul>
      
      
      
      <li><a title="Overview" href="installation-overview.html">Overview</a></li>
      
      
      
      
      
      
      <li><a title="System packages" href="installation-packages.html">System packages</a></li>
      
      
      
      
      
      
      <li><a title="Using Spack" href="installation-spack.html">Using Spack</a></li>
      
      
      
      <li class="subfolders">
        <a title="Building from source" href="#">Building from source</a>
        <ul>
          
          
          
          <li><a title="Preparation" href="installation-source-preparation.html">Preparation</a></li>
          
          
          
          
          
          <li><a title="Dependencies" href="installation-source-dependencies.html">Dependencies</a></li>
          
          
          
          
          
          <li><a title="Configuration" href="installation-source-configuration.html">Configuration</a></li>
          
          
          
          
          
          <li><a title="Building" href="installation-source-building.html">Building</a></li>
          
          
          
          
          
          <li><a title="Testing" href="installation-source-testing.html">Testing</a></li>
          
          
          
          
          
          <li><a title="Installation" href="installation-source-installation.html">Installation</a></li>
          
          
          
          
          
          <li><a title="Finding" href="installation-source-finding.html">Finding</a></li>
          
          
          
          
          
          <li><a title="Advanced" href="installation-source-advanced.html">Advanced</a></li>
          
          
          
          
          
          <li><a title="Troubleshooting" href="installation-source-troubleshooting.html">Troubleshooting</a></li>
          
          
          
          
          
          <li><a title="Notes on CMake" href="installation-source-cmake.html">Notes on CMake</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      
      
      
      <li><a title="Linking to preCICE" href="installation-linking.html">Linking to preCICE</a></li>
      
      
      
      <li class="subfolders">
        <a title="Language bindings" href="#">Language bindings</a>
        <ul>
          
          
          
          <li><a title="Fortran" href="installation-bindings-fortran.html">Fortran</a></li>
          
          
          
          
          
          <li><a title="Python" href="installation-bindings-python.html">Python</a></li>
          
          
          
          
          
          <li><a title="Matlab" href="installation-bindings-matlab.html">Matlab</a></li>
          
          
          
          
          
          <li><a title="Julia" href="installation-bindings-julia.html">Julia</a></li>
          
          
          
          
          
          <li><a title="Rust" href="installation-bindings-rust.html">Rust</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      
      
      
      <li><a title="Special systems" href="installation-special-systems.html">Special systems</a></li>
      
      
      
      
      
      
      <li><a title="Demo Virtual Machine" href="installation-vm.html">Demo Virtual Machine</a></li>
      
      
      
      
      
      
      <li><a title="preCICE distribution" href="installation-distribution.html">preCICE distribution</a></li>
      
      
      
      
    </ul>
  </li>
  
  
  
  
  
  <!-- Parent menu item has folderitems -->
  <li>
    <a title="Configuration" href="#">Configuration</a>
    <ul>
      
      
      
      <li><a title="Overview" href="configuration-overview.html">Overview</a></li>
      
      
      
      <li class="subfolders">
        <a title="Basics" href="#">Basics</a>
        <ul>
          
          
          
          <li><a title="Introduction" href="configuration-introduction.html">Introduction</a></li>
          
          
          
          
          
          <li><a title="Mapping" href="configuration-mapping.html">Mapping</a></li>
          
          
          
          
          
          <li><a title="Communication" href="configuration-communication.html">Communication</a></li>
          
          
          
          
          
          <li><a title="Coupling scheme" href="configuration-coupling.html">Coupling scheme</a></li>
          
          
          
          
          
          <li><a title="Acceleration" href="configuration-acceleration.html">Acceleration</a></li>
          
          
          
          
          
          <li><a title="Mesh exchange example" href="configuration-coupling-mesh-exchange.html">Mesh exchange example</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      <li class="subfolders">
        <a title="Advanced topics" href="#">Advanced topics</a>
        <ul>
          
          
          
          <li><a title="Multi coupling" href="configuration-coupling-multi.html">Multi coupling</a></li>
          
          
          
          
          
          <li><a title="Logging" href="configuration-logging.html">Logging</a></li>
          
          
          
          
          
          <li><a title="Export" href="configuration-export.html">Export</a></li>
          
          
          
          
          
          <li><a title="Action" href="configuration-action.html">Action</a></li>
          
          
          
          
          
          <li><a title="Watchpoint" href="configuration-watchpoint.html">Watchpoint</a></li>
          
          
          
          
          
          <li><a title="Watch integral" href="configuration-watchintegral.html">Watch integral</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      
      
      
      <li><a title="XML reference" href="configuration-xml-reference.html">XML reference</a></li>
      
      
      
      
    </ul>
  </li>
  
  
  
  
  
  <!-- Parent menu item has folderitems -->
  <li>
    <a title="Tooling" href="#">Tooling</a>
    <ul>
      
      
      
      <li><a title="Overview" href="tooling-overview.html">Overview</a></li>
      
      
      
      
      
      
      <li><a title="Artificial solver testing environment (ASTE)" href="tooling-aste.html">Artificial solver testing environment (ASTE)</a></li>
      
      
      
      
      
      
      <li><a title="Built-in tooling" href="tooling-builtin.html">Built-in tooling</a></li>
      
      
      
      
      
      
      <li><a title="Config visualization" href="tooling-config-visualization.html">Config visualization</a></li>
      
      
      
      
      
      
      <li><a title="FMI runner" href="tooling-fmi-runner.html">FMI runner</a></li>
      
      
      
      <li class="subfolders">
        <a title="Micro Manager" href="#">Micro Manager</a>
        <ul>
          
          
          
          <li><a title="Overview" href="tooling-micro-manager-overview.html">Overview</a></li>
          
          
          
          
          
          <li><a title="Get the Micro Manager" href="tooling-micro-manager-installation.html">Get the Micro Manager</a></li>
          
          
          
          
          
          <li><a title="Preparing micro simulation" href="tooling-micro-manager-prepare-micro-simulation.html">Preparing micro simulation</a></li>
          
          
          
          
          
          <li><a title="Configuration" href="tooling-micro-manager-configuration.html">Configuration</a></li>
          
          
          
          
          
          <li><a title="Running" href="tooling-micro-manager-running.html">Running</a></li>
          
          
          
          
          
          <li><a title="Logging" href="tooling-micro-manager-logging.html">Logging</a></li>
          
          
          
          
          
          <li><a title="Snapshot Computation" href="tooling-micro-manager-snapshot-configuration.html">Snapshot Computation</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      
      
      
      <li><a title="Performance analysis" href="tooling-performance-analysis.html">Performance analysis</a></li>
      
      
      
      
      
      
      <li><a title="RBF shape calculator" href="tooling-rbf-shape.html">RBF shape calculator</a></li>
      
      
      
      
    </ul>
  </li>
  
  
  
  
  
  <!-- Parent menu item has folderitems -->
  <li>
    <a title="Provided adapters" href="#">Provided adapters</a>
    <ul>
      
      
      
      <li><a title="Overview" href="adapters-overview.html">Overview</a></li>
      
      
      
      <li class="subfolders">
        <a title="CalculiX" href="#">CalculiX</a>
        <ul>
          
          
          
          <li><a title="Overview" href="adapter-calculix-overview.html">Overview</a></li>
          
          
          
          
          
          <li><a title="Get CalculiX" href="adapter-calculix-get-calculix.html">Get CalculiX</a></li>
          
          
          
          
          
          <li><a title="Get the adapter" href="adapter-calculix-get-adapter.html">Get the adapter</a></li>
          
          
          
          
          
          <li><a title="Build the adapter with PaStiX" href="adapter-calculix-pastix-build.html">Build the adapter with PaStiX</a></li>
          
          
          
          
          
          <li><a title="Configuration" href="adapter-calculix-config.html">Configuration</a></li>
          
          
          
          
          
          <li><a title="Troubleshooting" href="adapter-calculix-troubleshooting.html">Troubleshooting</a></li>
          
          
          
          
          
          <li><a title="Building on SuperMUC" href="adapter-calculix-supermuc.html">Building on SuperMUC</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      <li class="subfolders">
        <a title="code_aster" href="#">code_aster</a>
        <ul>
          
          
          
          <li><a title="Overview" href="adapter-code_aster.html">Overview</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      <li class="subfolders">
        <a title="deal.II" href="#">deal.II</a>
        <ul>
          
          
          
          <li><a title="Overview" href="adapter-dealii-overview.html">Overview</a></li>
          
          
          
          
          
          <li><a title="Get the adapter" href="adapter-dealii-get.html">Get the adapter</a></li>
          
          
          
          
          
          <li><a title="Configuration" href="adapter-dealii-configure.html">Configuration</a></li>
          
          
          
          
          
          <li><a title="For your own deal.II code" href="adapter-dealii-own-project.html">For your own deal.II code</a></li>
          
          
          
          
          
          <li><a title="Limitations and assumptions" href="adapter-dealii-limitations.html">Limitations and assumptions</a></li>
          
          
          
          
          
          <li><a title="Solver details" href="adapter-dealii-solver-details.html">Solver details</a></li>
          
          
          
          
          
          <li><a title="Coupling Meshes in deal.II" href="adapter-dealii-coupling-meshes.html">Coupling Meshes in deal.II</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      <li class="subfolders">
        <a title="DuMuX" href="#">DuMuX</a>
        <ul>
          
          
          
          <li><a title="Overview" href="adapter-dumux.html">Overview</a></li>
          
          
          
          
          
          <li><a title="Get the adapter" href="adapter-dumux-get.html">Get the adapter</a></li>
          
          
          
          
          
          <li><a title="Use the adapter" href="adapter-dumux-use.html">Use the adapter</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      <li class="subfolders">
        <a title="DUNE" href="#">DUNE</a>
        <ul>
          
          
          
          <li><a title="Overview" href="adapter-dune.html">Overview</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      <li class="subfolders">
        <a title="FEniCS" href="#">FEniCS</a>
        <ul>
          
          
          
          <li><a title="Overview" href="adapter-fenics.html">Overview</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      <li class="subfolders">
        <a title="G+Smo" href="#">G+Smo</a>
        <ul>
          
          
          
          <li><a title="Overview" href="adapter-gismo.html">Overview</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      <li class="subfolders">
        <a title="Nutils" href="#">Nutils</a>
        <ul>
          
          
          
          <li><a title="Overview" href="adapter-nutils.html">Overview</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      <li class="subfolders">
        <a title="OpenFOAM" href="#">OpenFOAM</a>
        <ul>
          
          
          
          <li><a title="Overview" href="adapter-openfoam-overview.html">Overview</a></li>
          
          
          
          
          
          <li><a title="Get the adapter" href="adapter-openfoam-get.html">Get the adapter</a></li>
          
          
          
          
          
          <li><a title="Configuration" href="adapter-openfoam-config.html">Configuration</a></li>
          
          
          
          
          
          <li><a title="Extending" href="adapter-openfoam-extend.html">Extending</a></li>
          
          
          
          
          
          <li><a title="OpenFOAM support" href="adapter-openfoam-support.html">OpenFOAM support</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      <li class="subfolders">
        <a title="SU2" href="#">SU2</a>
        <ul>
          
          
          
          <li><a title="Overview" href="adapter-su2-overview.html">Overview</a></li>
          
          
          
          
          
          <li><a title="Get the adapter" href="adapter-su2-get.html">Get the adapter</a></li>
          
          
          
          
          
          <li><a title="Configuration" href="adapter-su2-configure.html">Configuration</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      
    </ul>
  </li>
  
  
  
  
  
  <!-- Parent menu item has folderitems -->
  <li>
    <a title="Couple your code" href="#">Couple your code</a>
    <ul>
      
      
      
      <li><a title="Overview" href="couple-your-code-overview.html">Overview</a></li>
      
      
      
      
      
      
      <li><a title="Application programming interface" href="couple-your-code-api.html">Application programming interface</a></li>
      
      
      
      <li class="subfolders">
        <a title="Step by step" href="#">Step by step</a>
        <ul>
          
          
          
          <li><a title="Step 1 – Preparation" href="couple-your-code-preparing-your-solver.html">Step 1 – Preparation</a></li>
          
          
          
          
          
          <li><a title="Step 2 – Steering methods" href="couple-your-code-steering-methods.html">Step 2 – Steering methods</a></li>
          
          
          
          
          
          <li><a title="Step 3 – Mesh and data access" href="couple-your-code-mesh-and-data-access.html">Step 3 – Mesh and data access</a></li>
          
          
          
          
          
          <li><a title="Step 4 – Coupling flow" href="couple-your-code-coupling-flow.html">Step 4 – Coupling flow</a></li>
          
          
          
          
          
          <li><a title="Step 5 – Non-matching time step sizes" href="couple-your-code-time-step-sizes.html">Step 5 – Non-matching time step sizes</a></li>
          
          
          
          
          
          <li><a title="Step 6 – Implicit coupling" href="couple-your-code-implicit-coupling.html">Step 6 – Implicit coupling</a></li>
          
          
          
          
          
          <li><a title="Step 7 – Data initialization" href="couple-your-code-initializing-coupling-data.html">Step 7 – Data initialization</a></li>
          
          
          
          
          
          <li><a title="Step 8 – Mesh connectivity" href="couple-your-code-defining-mesh-connectivity.html">Step 8 – Mesh connectivity</a></li>
          
          
          
          
          
          <li><a title="Step 9 – Gradient Data" href="couple-your-code-gradient-data.html">Step 9 – Gradient Data</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      <li class="subfolders">
        <a title="Advanced topics" href="#">Advanced topics</a>
        <ul>
          
          
          
          <li><a title="Adapter software engineering" href="couple-your-code-adapter-software-engineering.html">Adapter software engineering</a></li>
          
          
          
          
          
          <li><a title="Initialization in existing MPI environment" href="couple-your-code-existing-mpi-environment.html">Initialization in existing MPI environment</a></li>
          
          
          
          
          
          <li><a title="Moving or changing meshes" href="couple-your-code-moving-or-changing-meshes.html">Moving or changing meshes</a></li>
          
          
          
          
          
          <li><a title="Just-in-time data mapping" href="couple-your-code-just-in-time-mapping.html">Just-in-time data mapping</a></li>
          
          
          
          
          
          <li><a title="Dealing with FEM meshes" href="couple-your-code-fem-meshes.html">Dealing with FEM meshes</a></li>
          
          
          
          
          
          <li><a title="Dealing with distributed meshes" href="couple-your-code-distributed-meshes.html">Dealing with distributed meshes</a></li>
          
          
          
          
          
          <li><a title="Direct access to received meshes" href="couple-your-code-direct-access.html">Direct access to received meshes</a></li>
          
          
          
          
          
          <li><a title="Time interpolation of coupling data" href="couple-your-code-waveform.html">Time interpolation of coupling data</a></li>
          
          
          
          
          
          <li><a title="Global data" href="couple-your-code-global-data.html">Global data</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      <li class="subfolders">
        <a title="Porting guides for major versions" href="#">Porting guides for major versions</a>
        <ul>
          
          
          
          <li><a title="Porting adapters in general" href="couple-your-code-porting-overview.html">Porting adapters in general</a></li>
          
          
          
          
          
          <li><a title="Porting from 1.x to 2.x" href="couple-your-code-porting-v1-2.html">Porting from 1.x to 2.x</a></li>
          
          
          
          
          
          <li class="active"><a title="Porting from 2.x to 3.x" href="couple-your-code-porting-v2-3.html">Porting from 2.x to 3.x</a></li>
          
          
          
        </ul>
      </li>
      
      
      
      
    </ul>
  </li>
  
  
  
  
  
  <!-- Parent menu item has folderitems -->
  <li>
    <a title="Running simulations" href="#">Running simulations</a>
    <ul>
      
      
      
      <li><a title="Overview" href="running-overview.html">Overview</a></li>
      
      
      
      
      
      
      <li><a title="Running locally" href="running-simple.html">Running locally</a></li>
      
      
      
      
      
      
      <li><a title="Distributed systems" href="running-distributed.html">Distributed systems</a></li>
      
      
      
      
      
      
      <li><a title="SLURM sessions" href="running-slurm.html">SLURM sessions</a></li>
      
      
      
      
      
      
      <li><a title="Output files" href="running-output-files.html">Output files</a></li>
      
      
      
      
    </ul>
  </li>
  
  
  
  
  
  <!-- Parent menu item has folderitems -->
  <li>
    <a title="Dev docs" href="#">Dev docs</a>
    <ul>
      
      
      
      <li><a title="Overview" href="dev-docs-overview.html">Overview</a></li>
      
      
      
      
      
      
      <li><a title="Naming" href="dev-docs-naming.html">Naming</a></li>
      
      
      
      
      
      
      <li><a title="Source documentation" href="dev-docs-sourcedocs.html">Source documentation</a></li>
      
      
      
      
      
      
      <li><a title="General coding conventions" href="dev-docs-dev-conventions.html">General coding conventions</a></li>
      
      
      
      
      
      
      <li><a title="Timings in preCICE" href="dev-docs-dev-eventtimings.html">Timings in preCICE</a></li>
      
      
      
      
      
      
      <li><a title="Logging" href="dev-docs-dev-logging.html">Logging</a></li>
      
      
      
      
      
      
      <li><a title="Optimization" href="dev-docs-dev-optimization.html">Optimization</a></li>
      
      
      
      
      
      
      <li><a title="Release workflow" href="dev-docs-dev-release.html">Release workflow</a></li>
      
      
      
      
      
      
      <li><a title="Running and writing tests" href="dev-docs-dev-testing.html">Running and writing tests</a></li>
      
      
      
      
      
      
      <li><a title="System tests" href="dev-docs-system-tests.html">System tests</a></li>
      
      
      
      
      
      
      <li><a title="Tooling" href="dev-docs-dev-tooling.html">Tooling</a></li>
      
      
      
      
      
      
      <li><a title="Release strategy" href="dev-docs-release-strategy.html">Release strategy</a></li>
      
      
      
      
      
      
      <li><a title="Publication strategy" href="dev-docs-publication-strategy.html">Publication strategy</a></li>
      
      
      
      
    </ul>
  </li>
  
  
  
  
  
  <!-- Parent menu item has folderitems -->
  <li>
    <a title="Documentation meta" href="#">Documentation meta</a>
    <ul>
      
      
      
      <li><a title="Overview" href="docs-meta-overview.html">Overview</a></li>
      
      
      
      
      
      
      <li><a title="Content guidelines" href="docs-meta-content-guidelines.html">Content guidelines</a></li>
      
      
      
      
      
      
      <li><a title="Cheatsheet" href="docs-meta-cheatsheet.html">Cheatsheet</a></li>
      
      
      
      
      
      
      <li><a title="Landing page" href="docs-meta-landing-page.html">Landing page</a></li>
      
      
      
      
      
      
      <li><a title="PDF generation" href="docs-meta-publish-to-pdf.html">PDF generation</a></li>
      
      
      
      
      
      
      <li><a title="Common issues" href="docs-meta-common-issues.html">Common issues</a></li>
      
      
      
      
      
      
      <li><a title="Search" href="docs-meta-search.html">Search</a></li>
      
      
      
      
      
      
      <li><a title="Migration guide" href="docs-meta-migration-guide.html">Migration guide</a></li>
      
      
      
      
    </ul>
  </li>
  
  
  
  
  <!-- if you aren't using the accordion, uncomment this block:
  <p class="external">
  <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
  </p>
  -->
</ul>
</nav>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

          </div>
          <main class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Porting from 2.x to 3.x</h1>
</div>



<div class="post-content">

    
    <div class="summary">
        <!-- https://github.com/jekyll/jekyll/issues/3571 -->
        This guide helps you to upgrade from preCICE 2.x to preCICE 3.x.

    </div>
    

    <div class="row">
        <div class="col-md-9 col-sm-8">
          
          <nav aria-label="table of contents">
          
          
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

    $('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers:  'h2,h3,h4'  });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

          
          </nav>
          
        </div>

        <div class="col-md-3 col-sm-4">
          
          <aside>
            
                <div class="text-right">
                    <a target="_blank" rel="noopener" href="https://github.com/precice/precice.github.io_future/edit/master/pages/docs/couple-your-code/couple-your-code-porting-v2-3.md" class="btn btn-default githubEditButton" role="button"><i class="fab fa-github fa-lg"></i> Edit me</a>
                </div>
            
            <div class="text-right">
              <small>Updated 19 Feb 24</small>
            </div>
          </aside>
          
        </div>
    </div>

   <!--
Missing:
#1352
-->

<h2 id="precice-api">preCICE API</h2>

<p>The following is a diff of how an adapter-port could look like. The guide continues underneath the code.</p>

<!-- Split code block. See https://github.com/precice/precice.github.io/commit/74e377cece4a221e00b5c56b1db3942ec70a6272. -->
<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- #include "precice/SolverInterface.hpp"
</span><span class="gi">+ #include "precice/precice.hpp"
</span>  
  turnOnSolver(); //e.g. setup and partition mesh
  
<span class="gd">- precice::SolverInterface participant("FluidSolver","precice-config.xml",rank,size); // constructor
</span><span class="gi">+ precice::Participant     participant("FluidSolver","precice-config.xml",rank,size); // constructor
</span>  
<span class="gd">- const std::string&amp; coric = precice::constants::actionReadIterationCheckpoint();
- const std::string&amp; cowic = precice::constants::actionWriteIterationCheckpoint();
- const std::string&amp; cowid = precice::constants::actionWriteInitialData();
</span>  
<span class="gd">- int dim = participant.getDimension();
</span><span class="gi">+ int dim = participant.getMeshDimensions("FluidMesh");
</span><span class="gd">- int meshID = precice.getMeshID("FluidMesh");
</span>
  int vertexSize; // number of vertices at wet surface
  // determine vertex count

  std::vector&lt;double&gt; coords(vertexSize*dim); // coords of vertices at wet surface
  // determine coordinates

  std::vector&lt;int&gt; vertexIDs(vertexSize);
<span class="gd">- precice.setMeshVertices(meshID, vertexSize, coords.data(), vertexIDs.data());
</span><span class="gi">+ precice.setMeshVertices("FluidMesh", coords, vertexIDs);
</span>  
<span class="gd">- int displID = precice.getDataID("Displacements", meshID);
- int forceID = precice.getDataID("Forces", meshID);
- std::vector&lt;double&gt; forces(vertexSize*dim);
- std::vector&lt;double&gt; displacements(vertexSize*dim);
</span><span class="gi">+ const int forceDim = participant.getDataDimensions("FluidMesh", "Forces")
+ const int displDim = participant.getDataDimensions("FluidMesh", "Displacements")
+ std::vector&lt;double&gt; forces(vertexSize*forceDimn);
+ std::vector&lt;double&gt; displacements(vertexSize*displDim);
</span>  
  double solverDt; // solver timestep size
  double preciceDt; // maximum precice timestep size
  double dt; // actual time step size
  
<span class="gd">- preciceDt = participant.initialize();
- if (participant.isActionRequired(cowid)) {
-   participant.writeBlockVectorData(forceID, vertexSize, vertexIDs.data(), forces.data());
-   participant.markActionFulfilled(cowid);
- }
- participant.initializeData();
</span><span class="gi">+ if (participant.requiresInitialData()) {
+   participant.writeData("FluidMesh", "Forces", vertexIDs, forces);
+ }
+ participant.initialize();
</span>  
  while (participant.isCouplingOngoing()){
<span class="gd">-   if(participant.isActionRequired(cowic)){
</span><span class="gi">+   if(participant.requiresWritingCheckpoint()){
</span>      saveOldState(); // save checkpoint
<span class="gd">-     participant.markActionFulfilled(cowic);
</span>    }
  
<span class="gi">+   preciceDt = participant.getMaxTimeStepSize();
</span>    solverDt = beginTimeStep(); // e.g. compute adaptive dt
    dt = min(preciceDt, solverDt);
  
<span class="gd">-   participant.readBlockVectorData(displID, vertexSize, vertexIDs.data(), displacements.data());
</span><span class="gi">+   participant.readData("FluidMesh", "Displacements", vertexIDs, dt, displacements);
</span>    setDisplacements(displacements);
    solveTimeStep(dt);
    computeForces(forces);
<span class="gd">-   participant.writeBlockVectorData(forceID, vertexSize, vertexIDs.data(), forces.data());
</span><span class="gi">+   participant.writeData("FluidMesh", "Forces", vertexIDs, forces);
</span>  
<span class="gd">-   preciceDt = participant.advance(dt);
</span><span class="gi">+   participant.advance(dt);
</span>  
<span class="gd">-   if (participant.isActionRequired(coric)) { // timestep not converged
</span><span class="gi">+   if (participant.requiresReadingCheckpoint()) {
</span>      reloadOldState(); // set variables back to checkpoint
<span class="gd">-     participant.markActionFulfilled(coric);
</span>    }
    else { // timestep converged
      endTimeStep(); // e.g. update variables, increment time
    }
  }
  participant.finalize(); // frees data structures and closes communication channels
  
  turnOffSolver();
</code></pre></div></div>

<ul>
  <li>The main preCICE header file and the main object was renamed. This means that you need to:
    <ul>
      <li>Replace <code class="language-plaintext highlighter-rouge">#include "precice/SolverInterface.hpp"</code> with <code class="language-plaintext highlighter-rouge">#include "precice/precice.hpp"</code>.</li>
      <li>Where declaring a preCICE object, replace the <code class="language-plaintext highlighter-rouge">precice::SolverInterface</code> type with <code class="language-plaintext highlighter-rouge">precice::Participant</code>.</li>
      <li>Where constructing a preCICE object, replace the <code class="language-plaintext highlighter-rouge">precice::SolverInterface( ... )</code> constructor with <code class="language-plaintext highlighter-rouge">precice::Participant( ... )</code>.</li>
      <li>Consider renaming your objects from, e.g., <code class="language-plaintext highlighter-rouge">interface</code> to <code class="language-plaintext highlighter-rouge">participant</code>, to better reflect the purpose and to be consistent with the rest of the changes.</li>
    </ul>
  </li>
  <li>Steering methods
    <ul>
      <li>Replace <code class="language-plaintext highlighter-rouge">double preciceDt = initialize()</code> and <code class="language-plaintext highlighter-rouge">double preciceDt = advance(dt)</code> with <code class="language-plaintext highlighter-rouge">initialize()</code> and <code class="language-plaintext highlighter-rouge">advance(dt)</code>, as they no longer have a return value.</li>
      <li>Use <code class="language-plaintext highlighter-rouge">double preciceDt = getMaxTimeStepSize()</code>, where you need the max time step size or the relative end of the time window.</li>
    </ul>
  </li>
  <li>Dimensions
    <ul>
      <li>Replace <code class="language-plaintext highlighter-rouge">getDimensions()</code> with <code class="language-plaintext highlighter-rouge">getMeshDimensions(meshName)</code></li>
      <li>Replace any custom logic to determine the dimensionality of data with <code class="language-plaintext highlighter-rouge">getDataDimensions(meshName, dataName)</code></li>
    </ul>
  </li>
  <li>Migrate from using mesh and data ids to directly using names
    <ul>
      <li>Remove the now obsolete calls to <code class="language-plaintext highlighter-rouge">getMeshID()</code> and <code class="language-plaintext highlighter-rouge">getDataID()</code> and any related variables / user-defined types.</li>
      <li>Replace the use of mesh IDs with the mesh name.</li>
      <li>Replace the use of data IDs with the respective mesh and data names (both are needed).</li>
    </ul>
  </li>
  <li>Migrate connectivity information to the vertex-only API. All <code class="language-plaintext highlighter-rouge">setMeshX</code> methods take vertex IDs as input and return nothing.
    <ul>
      <li>Directly define face elements or cells of your coupling mesh available in your solver by passing their vectices to preCICE, which automatically handles edges of triangles etc. See <a href="couple-your-code-defining-mesh-connectivity">Mesh Connectivity</a> for more information.</li>
      <li>Rename <code class="language-plaintext highlighter-rouge">setMeshTriangleWithEdges</code> to <code class="language-plaintext highlighter-rouge">setMeshTriangle</code> and <code class="language-plaintext highlighter-rouge">setMeshQuadWithEdges</code> to <code class="language-plaintext highlighter-rouge">setMeshQuad</code>. The edge-based implementation was removed.</li>
      <li>Use the new bulk functions to reduce sanitization overhead: <code class="language-plaintext highlighter-rouge">setMeshEdges</code>, <code class="language-plaintext highlighter-rouge">setMeshTriangles</code>, <code class="language-plaintext highlighter-rouge">setMeshQuads</code>, <code class="language-plaintext highlighter-rouge">setMeshTetrahedra</code>.</li>
    </ul>
  </li>
  <li>Implicit coupling
    <ul>
      <li>Remove <code class="language-plaintext highlighter-rouge">precice::constants::actionReadIterationCheckpoint()</code> and <code class="language-plaintext highlighter-rouge">precice::constants::actionWriteIterationCheckpoint()</code>
        <ul>
          <li>Replace <code class="language-plaintext highlighter-rouge">isActionRequired()</code> of the above actions with <code class="language-plaintext highlighter-rouge">requiresReadingCheckpoint()</code> or <code class="language-plaintext highlighter-rouge">requiresWritingCheckpoint()</code>.</li>
          <li>Remove <code class="language-plaintext highlighter-rouge">markActionFulfilled()</code> of the above actions. It is now implied that a <code class="language-plaintext highlighter-rouge">requires*()</code> is directly executed/fulfilled.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Migrate data access
    <ul>
      <li>Replace the commands to read data: <code class="language-plaintext highlighter-rouge">readBlockVectorData</code>, <code class="language-plaintext highlighter-rouge">readVectorData</code>, <code class="language-plaintext highlighter-rouge">readBlockScalarData</code>, <code class="language-plaintext highlighter-rouge">readScalarData</code> with the single command <code class="language-plaintext highlighter-rouge">readData</code>.</li>
      <li>Replace the commands to write data: <code class="language-plaintext highlighter-rouge">writeBlockVectorData</code>, <code class="language-plaintext highlighter-rouge">writeVectorData</code>, <code class="language-plaintext highlighter-rouge">writeBlockScalarData</code>, <code class="language-plaintext highlighter-rouge">writeScalarData</code> with the single command <code class="language-plaintext highlighter-rouge">writeData</code>.</li>
      <li>Replace the commands to write gradient data: <code class="language-plaintext highlighter-rouge">writeBlockVectorGradientData</code>, <code class="language-plaintext highlighter-rouge">writeVectorGradientData</code>, <code class="language-plaintext highlighter-rouge">writeBlockScalarGradientData</code>, <code class="language-plaintext highlighter-rouge">writeScalarGradientData</code> with the single command <code class="language-plaintext highlighter-rouge">writeGradientData</code>.</li>
      <li>The signature of <code class="language-plaintext highlighter-rouge">readData</code>, <code class="language-plaintext highlighter-rouge">writeData</code> and <code class="language-plaintext highlighter-rouge">writeGradientData</code> has changed from <code class="language-plaintext highlighter-rouge">const int*</code>, <code class="language-plaintext highlighter-rouge">const double*</code>, and <code class="language-plaintext highlighter-rouge">double*</code> to <code class="language-plaintext highlighter-rouge">precice::span&lt;const VertexID&gt;</code>, <code class="language-plaintext highlighter-rouge">precice::span&lt;const double&gt;</code>, and <code class="language-plaintext highlighter-rouge">span&lt;double&gt;</code>. The sizes of passed spans are checked by preCICE. spans can be constructed using a pointer and size, or by a contigous container. Examples for the latter are <code class="language-plaintext highlighter-rouge">std::vector</code>, <code class="language-plaintext highlighter-rouge">std:array</code>, <code class="language-plaintext highlighter-rouge">Eigen::VectorXd</code>, and also <code class="language-plaintext highlighter-rouge">std::span</code>.</li>
      <li>To simplify migration to <code class="language-plaintext highlighter-rouge">readData()</code>, use <code class="language-plaintext highlighter-rouge">getMaxTimeStepSize()</code> as relative read time for now to always read data at the end of the time window. Read up on <a href="couple-your-code-waveform.html">time interpolation</a> once you finished the port.</li>
    </ul>
  </li>
  <li>Migrate data initialization
    <ul>
      <li>Move the data initalization before the call to <code class="language-plaintext highlighter-rouge">initialize()</code>. You have to initialize the data if <code class="language-plaintext highlighter-rouge">requiresInitialData()</code> returns <code class="language-plaintext highlighter-rouge">true</code>.</li>
      <li>Remove <code class="language-plaintext highlighter-rouge">initializeData()</code>. The function <code class="language-plaintext highlighter-rouge">initializeData()</code> has been merged into <code class="language-plaintext highlighter-rouge">ìnitialize()</code>.</li>
      <li>Remove <code class="language-plaintext highlighter-rouge">precice::constants::actionWriteInitialData()</code>.</li>
      <li>Remove <code class="language-plaintext highlighter-rouge">markActionFulfilled()</code> of write initial data.</li>
      <li>Replace <code class="language-plaintext highlighter-rouge">isActionRequired()</code> of write initial data with <code class="language-plaintext highlighter-rouge">requiresInitialData()</code>.</li>
    </ul>
  </li>
  <li>Rename the functions:
    <ul>
      <li>Replace <code class="language-plaintext highlighter-rouge">getMeshVerticesAndIDs</code> with <code class="language-plaintext highlighter-rouge">getMeshVertexIDsAndCoordinates</code>. Change the input argument meshID to meshName and swap the arguments for IDs and coordinates.</li>
      <li>Replace <code class="language-plaintext highlighter-rouge">isMeshConnectivityRequired</code> with <code class="language-plaintext highlighter-rouge">requiresMeshConnectivityFor</code>. Instead of the input argument <code class="language-plaintext highlighter-rouge">meshID</code>, pass the <code class="language-plaintext highlighter-rouge">meshName</code>.</li>
      <li>Replace <code class="language-plaintext highlighter-rouge">isGradientDataRequired</code> with <code class="language-plaintext highlighter-rouge">requiresGradientDataFor</code>. Instead of the input argument <code class="language-plaintext highlighter-rouge">dataID</code>, pass the <code class="language-plaintext highlighter-rouge">meshName</code> and <code class="language-plaintext highlighter-rouge">dataName</code>.</li>
    </ul>
  </li>
  <li>Remove the following without a replacement:
    <ul>
      <li>Remove <code class="language-plaintext highlighter-rouge">mapWriteDataFrom()</code> and <code class="language-plaintext highlighter-rouge">mapReadDataTo()</code> as custom timings were removed.</li>
      <li>Remove <code class="language-plaintext highlighter-rouge">hasMesh()</code> and <code class="language-plaintext highlighter-rouge">hasData()</code> as there is no real usecase for them. All errors are unrecoverable.</li>
      <li>Remove <code class="language-plaintext highlighter-rouge">hasToEvaluateSurrogateModel()</code> and <code class="language-plaintext highlighter-rouge">hasToEvaluateFineModel()</code> as they were stubs of a long-removed feature.</li>
      <li>Remove <code class="language-plaintext highlighter-rouge">getMeshVertices()</code> and <code class="language-plaintext highlighter-rouge">getMeshVertexIDsFromPositions()</code>. This information is already known by the adapter. We docummented <a href="couple-your-code-defining-mesh-connectivity.html">strategies on how to handle this</a> in adapters.</li>
      <li>Remove <code class="language-plaintext highlighter-rouge">isReadDataAvailable()</code> and <code class="language-plaintext highlighter-rouge">isWriteDataRequired()</code>. Due to time interpolation, writing generates samples in time, and reading is always possible between the current time and the end of the current time window.</li>
    </ul>
  </li>
</ul>

<h3 id="add-relativereadtime-for-all-read-data-calls">Add <code class="language-plaintext highlighter-rouge">relativeReadTime</code> for all read data calls</h3>

<p>The previously optional argument <code class="language-plaintext highlighter-rouge">relativeReadTime</code> is now mandatory for read data calls. This requires you to update all read data calls. See <a href="couple-your-code-waveform">time interpolation</a> for more details on this argument. If you don’t want to use subcycling or time interpolation, you can simply get the required <code class="language-plaintext highlighter-rouge">relativeReadTime</code> by calling <code class="language-plaintext highlighter-rouge">double preciceDt = getMaxTimeStepSize()</code> call. Change:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- couplingInterface.readBlockVectorData(meshName, dataReadName, numberOfVertices, vertexIDs.data(), readData.data());
</span><span class="gi">+ preciceDt = participant.getMaxTimeStepSize();
+ participant.readData(meshName, dataReadName, vertexIDs, preciceDt, readData)
</span></code></pre></div></div>

<p>If you use subcycling, please do the following:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- couplingInterface.readBlockVectorData(meshName, dataReadName, numberOfVertices, vertexIDs.data(), readData.data());
</span><span class="gi">+ preciceDt = participant.getMaxTimeStepSize();
</span>  double dt = min(preciceDt, solverDt);
<span class="gi">+ participant.readData(meshName, dataReadName, vertexIDs, dt, readData)
</span></code></pre></div></div>

<h3 id="remove-initializedata-calls">Remove <code class="language-plaintext highlighter-rouge">initializeData()</code> calls</h3>

<p>The API function <code class="language-plaintext highlighter-rouge">initializeData()</code> has been removed in <a href="https://github.com/precice/precice/pull/1350">#1350</a>. <code class="language-plaintext highlighter-rouge">initialize()</code> now takes care of all the initialization – including data initialization. This means, you have to call <code class="language-plaintext highlighter-rouge">initialize()</code>, where you previously called <code class="language-plaintext highlighter-rouge">initializeData()</code>. Be aware that this means that you have to write initial data before calling <code class="language-plaintext highlighter-rouge">initialize()</code>. Change:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- double dt = 0;
- dt        = couplingInterface.initialize();
</span>  std::vector&lt;double&gt; writeData(dimensions, writeValue);

  // Write initial data before calling initialize()
<span class="gd">-  const std::string &amp; cowid = actionWriteInitialData();
-  if (couplingInterface.isActionRequired(cowid)) {
-    couplingInterface.writeVectorData(writeDataID, vertexIDs, writeData.data());
-    couplingInterface.markActionFulfilled(cowid);
</span><span class="gi">+  if (participant.requiresInitialData()) {
+    participant.writeData(meshName, dataWriteName, vertexIDs, writeData);
</span>  }

  // Move initialize to the place where you called initializeData() previously.
<span class="gd">- couplingInterface.initializeData();
</span><span class="gi">+ participant.initialize();
+ double dt = participant.getMaxTimeWindowSize();
</span></code></pre></div></div>

<p>Typical error message that should lead you here:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>error: ‘class precice::Participant’ has no member named ‘initializeData’<span class="p">;</span> did you mean ‘initialize’?
   63 |   participant.initializeData<span class="o">()</span><span class="p">;</span>
      |           ^~~~~~~~~~~~~~
      |           initialize
</code></pre></div></div>

<h2 id="precice-configuration-file">preCICE configuration file</h2>

<ul>
  <li>The XML tag <code class="language-plaintext highlighter-rouge">&lt;solver-interface&gt;</code> was removed and all underlying functionality was moved to the <code class="language-plaintext highlighter-rouge">&lt;precice-configuration&gt;</code> tag. Remove the lines including <code class="language-plaintext highlighter-rouge">&lt;solver-interface&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;/solver-interface&gt;</code>, and move any attributes (such as <code class="language-plaintext highlighter-rouge">experimental</code>) from the <code class="language-plaintext highlighter-rouge">solver-interface</code> to the <code class="language-plaintext highlighter-rouge">precice-configuration</code> tag. Move the <code class="language-plaintext highlighter-rouge">sync-mode</code> attribute to the new <code class="language-plaintext highlighter-rouge">&lt;profiling&gt;</code> tag (see below).</li>
  <li>The <code class="language-plaintext highlighter-rouge">dimensions</code> configuration is now defined per mesh. Move the <code class="language-plaintext highlighter-rouge">dimensions="2"</code> or <code class="language-plaintext highlighter-rouge">dimensions="3"</code> from the <code class="language-plaintext highlighter-rouge">&lt;solver-interface&gt;</code> tag to each <code class="language-plaintext highlighter-rouge">&lt;mesh&gt;</code> tag: <code class="language-plaintext highlighter-rouge">&lt;mesh name="MeshOne" dimensions="3"&gt;</code>.</li>
  <li>Rename the <code class="language-plaintext highlighter-rouge">&lt;m2n: ... /&gt;</code> attributes <code class="language-plaintext highlighter-rouge">from</code> -&gt; <code class="language-plaintext highlighter-rouge">acceptor</code> and <code class="language-plaintext highlighter-rouge">to</code> -&gt; <code class="language-plaintext highlighter-rouge">connector</code>.</li>
  <li>
    <p>You can now add <code class="language-plaintext highlighter-rouge">&lt;profiling mode="all" /&gt;</code> after the <code class="language-plaintext highlighter-rouge">&lt;log&gt;</code> tag if you need full profiling data.</p>
  </li>
  <li>Participants
    <ul>
      <li>Replace <code class="language-plaintext highlighter-rouge">&lt;use-mesh provide="true" ... /&gt;</code> with <code class="language-plaintext highlighter-rouge">&lt;provide-mesh ... /&gt;</code>, and <code class="language-plaintext highlighter-rouge">&lt;use-mesh provide="false" ... /&gt;</code> with <code class="language-plaintext highlighter-rouge">&lt;receive-mesh ... /&gt;</code>.</li>
      <li>Move and rename the optional attribute <code class="language-plaintext highlighter-rouge">&lt;read-data: ... waveform-order="1" /&gt;</code> to <code class="language-plaintext highlighter-rouge">&lt;data:scalar/vector ... waveform-degree="1"</code>.</li>
      <li>Replace <code class="language-plaintext highlighter-rouge">&lt;export:vtk /&gt;</code> for parallel participants with <code class="language-plaintext highlighter-rouge">&lt;export:vtu /&gt;</code> or <code class="language-plaintext highlighter-rouge">&lt;export:vtp /&gt;</code>.</li>
      <li>Replace mapping constraint <code class="language-plaintext highlighter-rouge">scaled-consistent</code> with <code class="language-plaintext highlighter-rouge">scaled-consistent-surface</code>.</li>
      <li>Remove all timings in the mapping configuration <code class="language-plaintext highlighter-rouge">&lt;mapping: ... timing="initial/onadvance/ondemand" /&gt;</code>. preCICE now fully controls the mapping.</li>
      <li>Remove the preallocations in the mapping configuration <code class="language-plaintext highlighter-rouge">&lt;mapping: ... preallocation="tree/compute/estimate/save/off" /&gt;</code>. We always use the superior <code class="language-plaintext highlighter-rouge">tree</code> method.</li>
      <li>
        <p>Replace all RBF related <code class="language-plaintext highlighter-rouge">&lt;mapping:rbf-... /&gt;</code> tags. RBF mappings are now defined in terms of the applied solver (current options <code class="language-plaintext highlighter-rouge">&lt;mapping:rbf-global-direct ...</code>, <code class="language-plaintext highlighter-rouge">&lt;mapping:rbf-global-iterative</code> or <code class="language-plaintext highlighter-rouge">&lt;mapping:rbf-pum-direct ...</code>) and the applied basis function as a subtag of the solver. Users should use the additionally added auto selection of an appropriate solver, which omits the solver specification, as follows:</p>

        <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;mapping:rbf</span>  <span class="err">...</span><span class="nt">&gt;</span>
    <span class="nt">&lt;basis-function:...</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/mapping:rbf&gt;</span>
</code></pre></div>        </div>

        <p>Example:</p>

        <p>preCICE version 2 RBF configuration:</p>

        <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;mapping:compact-polynomial-c0</span> <span class="na">direction=</span><span class="s">"read"</span> <span class="na">from=</span> <span class="s">...</span> <span class="na">support-radius=</span><span class="s">"0.3"</span> <span class="nt">/&gt;</span>
</code></pre></div>        </div>

        <p>corresponding preCICE version 3 RBF configuration (using the recommended auto selection):</p>

        <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;mapping:rbf</span>  <span class="na">direction=</span><span class="s">"read"</span> <span class="na">from=</span> <span class="s">...</span><span class="nt">&gt;</span>
    <span class="nt">&lt;basis-function:compact-polynomial-c0</span> <span class="na">support-radius=</span><span class="s">"0.3"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/mapping:rbf&gt;</span>
</code></pre></div>        </div>

        <p>A specific solver should only be configured if you want to force preCICE to use and stick to a certain solver, independent of your problem size and execution.</p>
      </li>
      <li>Rename <code class="language-plaintext highlighter-rouge">&lt;mapping:rbf... use-qr-decomposition="true" /&gt;</code> to <code class="language-plaintext highlighter-rouge">&lt;mapping:rbf-global-direct ... &gt; &lt;basis-function:... /&gt; &lt;/mapping:rbf-global-direct&gt;</code>.</li>
      <li>We dropped quite some functionality concerning <a href="https://precice.org/configuration-action.html">data actions</a> as these were not used to the best of our knowledge and were hard to maintain:
        <ul>
          <li>Removed deprecated action timings <code class="language-plaintext highlighter-rouge">regular-prior</code>, <code class="language-plaintext highlighter-rouge">regular-post</code>, <code class="language-plaintext highlighter-rouge">on-exchange-prior</code>, and <code class="language-plaintext highlighter-rouge">on-exchange-post</code>.</li>
          <li>Removed action timings <code class="language-plaintext highlighter-rouge">read-mapping-prior</code>, <code class="language-plaintext highlighter-rouge">write-mapping-prior</code>, and <code class="language-plaintext highlighter-rouge">on-time-window-complete-post</code>.</li>
          <li>Removed <code class="language-plaintext highlighter-rouge">ComputeCurvatureAction</code> and <code class="language-plaintext highlighter-rouge">ScaleByDtAction</code> actions.</li>
          <li>Removed callback functions <code class="language-plaintext highlighter-rouge">vertexCallback</code> and <code class="language-plaintext highlighter-rouge">postAction</code> from <code class="language-plaintext highlighter-rouge">PythonAction</code> interface.</li>
          <li>Removed timewindowsize from the <code class="language-plaintext highlighter-rouge">performAction</code> signature of <code class="language-plaintext highlighter-rouge">PythonAction</code>. The new signature is <code class="language-plaintext highlighter-rouge">performAction(time, data)</code></li>
          <li>Using actions with multiple couping schemes and mixed time window sizes is not well defined!</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Coupling schemes
    <ul>
      <li>Remove <code class="language-plaintext highlighter-rouge">&lt;extraplation-order value="..." /&gt;</code> in <code class="language-plaintext highlighter-rouge">&lt;coupling-scheme&gt;</code>. Contact us if you need this feature.</li>
      <li>Replace <code class="language-plaintext highlighter-rouge">&lt;min-iteration-convergence-measure min-iterations="3" ... /&gt;</code> by <code class="language-plaintext highlighter-rouge">&lt;min-iterations value="3"/&gt;</code>. Not defining convergence measures leads to iterations until <code class="language-plaintext highlighter-rouge">max-iterations</code> is reached.</li>
      <li>We removed the plain <code class="language-plaintext highlighter-rouge">Broyden</code> acceleration. You could use <code class="language-plaintext highlighter-rouge">IQN-IMVJ</code> instead, which is a <a href="http://hdl.handle.net/2117/191193">multi-vector Broyden variant</a>.</li>
    </ul>
  </li>
</ul>

<h2 id="building-precice">Building preCICE</h2>

<p>Rename CMake configuration variables as follows:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">PRECICE_PETScMapping</code> -&gt; <code class="language-plaintext highlighter-rouge">PRECICE_FEATURE_PETSC_MAPPING</code></li>
  <li><code class="language-plaintext highlighter-rouge">PRECICE_MPICommunication</code> -&gt; <code class="language-plaintext highlighter-rouge">PRECICE_FEATURE_MPI_COMMUNICATION</code></li>
  <li><code class="language-plaintext highlighter-rouge">PRECICE_Packages</code> -&gt; <code class="language-plaintext highlighter-rouge">PRECICE_CONFIGURE_PACKAGE_GENERATION</code></li>
  <li><code class="language-plaintext highlighter-rouge">PRECICE_PythonActions</code> -&gt; <code class="language-plaintext highlighter-rouge">PRECICE_FEATURE_PYTHON_ACTIONS</code></li>
  <li><code class="language-plaintext highlighter-rouge">PRECICE_ENABLE_C</code> -&gt; <code class="language-plaintext highlighter-rouge">PRECICE_BINDINGS_C</code></li>
  <li><code class="language-plaintext highlighter-rouge">PRECICE_ENABLE_FORTRAN</code> -&gt;<code class="language-plaintext highlighter-rouge">PRECICE_BINDINGS_FORTRAN</code></li>
  <li><code class="language-plaintext highlighter-rouge">PRECICE_ENABLE_LIBBACKTRACE</code>  -&gt; <code class="language-plaintext highlighter-rouge">PRECICE_FEATURE_LIBBACKTRACE_STACKTRACES</code></li>
</ul>

<h2 id="language-bindings">Language bindings</h2>

<p>The renaming of the preCICE API from <code class="language-plaintext highlighter-rouge">SolverInterface</code> to <code class="language-plaintext highlighter-rouge">preCICE</code> also applies to all language bindings. The C++ header change <code class="language-plaintext highlighter-rouge">precice/SolverInterface.hpp</code> to <code class="language-plaintext highlighter-rouge">precice/precice.hpp</code> becomes:</p>

<ul>
  <li>In C: Replace <code class="language-plaintext highlighter-rouge">#include "precice/SolverInterfaceC.h"</code> with <code class="language-plaintext highlighter-rouge">#include "precice/preciceC.h"</code> and <code class="language-plaintext highlighter-rouge">precicec_createSolverInterface( ... )</code> with <code class="language-plaintext highlighter-rouge">precicec_createParticipant( ... )</code>.</li>
  <li>In Julia: Replace <code class="language-plaintext highlighter-rouge">precicec_createSolverInterface( ... )</code> with <code class="language-plaintext highlighter-rouge">precicec_createParticipant( ... )</code>.</li>
  <li>In Matlab: Replace <code class="language-plaintext highlighter-rouge">SolverInterface</code> with <code class="language-plaintext highlighter-rouge">Participant</code> everywhere.</li>
  <li>In Fortran, Python: You don’t need to change anything.</li>
</ul>

<!--
- Rename Fortran function `precicef_ongoing()` to `precicef_is_coupling_ongoing()`
- Removed `precicef_write_data_required()`, `precicef_read_data_available()`, `precicef_action_required()`.
-->

<h2 id="profiling">Profiling</h2>

<ul>
  <li>There are three profiling modes now: <code class="language-plaintext highlighter-rouge">off</code>, <code class="language-plaintext highlighter-rouge">fundamental</code> (default), <code class="language-plaintext highlighter-rouge">all</code>.</li>
  <li>Add <code class="language-plaintext highlighter-rouge">&lt;profiling mode="all" /&gt;</code> inside the <code class="language-plaintext highlighter-rouge">&lt;precice-configuration&gt;</code> tag if you need detailed profiling data.</li>
  <li>If you relied on <code class="language-plaintext highlighter-rouge">sync-mode="on"</code>, remove it from <code class="language-plaintext highlighter-rouge">&lt;precice-configuration&gt;</code> and add it to the profiling tag <code class="language-plaintext highlighter-rouge">&lt;profiling synchronize="true" /&gt;</code>.</li>
</ul>


    



<!-- Breadcrumb metadata -->

<script type="application/ld+json">
{
"@context": "https://schema.org",
"@type": "BreadcrumbList",
"itemListElement": [









{
  "@type": "ListItem",
  "position": 1,
  "name": "Docs",
  "item": "https://precice.org/docs.html"
}













































































































































































































































































]}
</script>


</div>


          </main>
        </div>
        
    </div>
    <footer class="background-dark">
  <div class="container">
    <div class="row equal">
      <div class="col-md-4">
        <nav aria-label="Footer left">
          <ul class="list-unstyled">
            <li>
              <a href="fundamentals-literature-guide.html">Cite preCICE</a>
            </li>
            <li>
              <a href="community-contribute-to-precice.html">Contribute</a>
            </li>
            <li>
              <a href="community-support-precice.html">Get support</a>
            </li>
            <li>
              <a href="community-training.html">Get training</a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="col-md-4">
        <nav aria-label="Footer right">
          <ul class="list-unstyled">
            <li>
              <a class="no-icon" href="https://precice.discourse.group">Forum on Discourse</a>
            </li>
            <li>
              <a class="no-icon" href="https://github.com/precice">preCICE on GitHub</a>
            </li>
            <li>
              <a href="fundamentals-license.html">License</a>
            </li>
            <li>
              <a href="about.html">Impressum / Legal</a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="col-md-4">
        <p>
        <a class="no-icon" rel="license" href="https://creativecommons.org/licenses/by/4.0/">
          <img alt="This work is licensed under a Creative Commons Attribution 4.0 International License." src="images/licensebutton-by-40_88x31.png" />
        </a>
        </p>
        <p>
        Page last updated: Feb 19, 2024<br>
        Site last updated: May 17, 2025
        </p>
      </div>
    </div>
  </div>
</footer>

</body>


</html>
